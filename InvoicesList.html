<!DOCTYPE html>
<html>
  <head>
    <base target="_top" />
    <meta charset="UTF-8" />
    <title>List of Invoices</title>
    <link
      rel="stylesheet"
      href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css"
    />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>
  <body class="container py-4">
    <button class="btn btn-link mb-3" onclick="goHome()">
      ‚Üê Back to Main Page
    </button>
    <h2 class="mb-4">List of Invoices</h2>

    <table
      id="invoiceTable"
      class="display table table-bordered"
      style="width: 100%"
    >
      <thead class="table-light">
        <tr>
          <th>Project Name</th>
          <th>Invoice Number</th>
          <th>Invoice Date</th>
          <th>Total</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <script>
      function goHome() {
        google.script.run
          .withSuccessHandler(function (html) {
            document.open();
            document.write(html);
            document.close();
          })
          .loadPage("Home");
      }

      function populateTable(data) {
        const tbody = $("#invoiceTable tbody");
        data.forEach((row) => {
          const tr = `
            <tr>
              <td>${row.projectName}</td>
              <td>${row.invoiceNumber}</td>
              <td>${row.invoiceDate}</td>
              <td>${row.total}</td>
              <td>
                <button class="btn btn-sm btn-outline-primary me-1">View</button>
                <button class="btn btn-sm btn-outline-secondary me-1">Edit</button>
                <button class="btn btn-sm btn-outline-danger me-1">Delete</button>
                <button class="btn btn-sm btn-outline-success">Copy</button>
              </td>
            </tr>`;
          tbody.append(tr);
        });

        $("#invoiceTable").DataTable();
      }

      google.script.run.withSuccessHandler(populateTable).getInvoiceList();
    </script>
  </body>
</html>
